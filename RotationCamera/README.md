RotationCamera is a modified version of HelloVideoCamera which auto-rotates based on device orientation.

There are 3 rotations managed by this code:
	-screen window rotation (the ForeignWindowControl)
	-video viewfinder buffer rotation
	-video buffer rotation

Screen window rotation is merely the rotation of the camera buffers for display on the screen.  Pixel order delivered by the camera is unaffected by screen window rotation.
Video viewfinder rbuffer otation is performed by the camera service (if supported), and results in re-ordering of the pixels in the buffer delivered by the camera to the viewfinder window.  A disruption in the visual stream is incurred when changing the viewfinder rotation of the camera because physical buffers need to be reallocated (eg. for a switch from 16:9 to 9:16 aspect).  As a result, you should avoid rotating the viewfinder buffer unless you require pixels to be oriented a certain way.
Setting either of the above 2 rotations will produce a the same end result visually.

So why would you ever change the viewfinder buffer rotation?  You would change this if you need to send the buffers into a video encoder which expects frames to be delivered upright.  The BB10 video recorder/encoder takes upright video buffers and produces an upright video, unlike some other platforms which actually encode video in only one orientation, but rely on the video player to display it correctly (similar to how EXIF orientation hints work in a JPEG).

The video buffer rotation is essentially reserved for future use on hardware which may support independent configuration of the viewfinder buffers and video buffers.  (eg. to display a low-resolution viewfinder while recording video in higher resolution than the display supports).  On all current BB10 hardware, this feature is not supported, and instead, the video viewfinder buffers are used for both display on-screen and as input into the video encoder.  This limitation can be discovered by querying for CAMERA_FEATURE_PREVIEWISVIDEO.  On such devices, you should configure video buffer rotation to the same angle as the viewfinder buffer rotation.

So with that description out of the way, I can explain how this sample works.
This sample works by computing the desired angle of rotation for the picture.  This angle is the complementary angle of the reported display direction.  eg. if the display direction is 90 degrees, then the desired angle for the picture is set to 270 degrees.  Note that this may seem counter-intuitive, until you understand that the display direction does not actually describe the direction that the device was rotated, but instead indicates which edge of the screen is not top-most.  (eg. 90 degree display direction means the 3-o'clock edge of the screen is not topmost, or that the device has been rotated 90 degrees COUNTER-clockwise, which is the same as 270 degrees clockwise).
If video viewfinder (or video) buffer rotation is not required (eg. because you are not recording video), then only the screen window rotation is updated.
The equality:   desired angle = screen angle + viewfinder angle    is maintained at all times.
If video recording is desired (eg. the start recording button is pressed), then only at that time will the video viewfinder buffer rotation be applied.  As a consequence of the above equality, the screen window rotation must also be recalculated at this time in order to maintain a visually correct presentation.
There is some extra code in there to handle future cases where video buffer rotation is configurable independently of video viewfinder buffer rotation -- in this case, the video viewfinder buffer rotation is never modified, as it is not necessary.  Instead, only the video buffer rotation is changed.

This same rotation logic could be applied to the photo viewfinder, however there is not usually a need to rotate photo viewfinder buffers, as they are not being fed into a video encoder.  The only reason to do so would be if you need to do upright image processing on the pixels of the buffer (or expect review images in a certain orientation).  Not all hardware supports rotating the photo viewfinder buffers anyways, so you should plan for unrotatable photo viewfinder buffers when designing image processing solutions.  Photo capture rotation is achieved either by updating the photo output buffer rotation (if supported), or more commonly, by indicating the current device orientation using camera_set_device_orientation().  This will be used in the calculation of the EXIF orientation hint when encoding JPEGs.

A special note about the front-facing camera.  When dealing with the front-facing camera, it is important to understand that the angle at which the device has been rotated is relative to a user holding the device and looking at the screen.  Since the front-facing camera points in the opposite direction, the device rotation must be reversed.  It helps to picture yourself as the photographer holding the camera.  If the user rotates the device clockwise... from the photographer's perspective, the camera has been rotated counter-clockwise.  I have tried to be fairly descriptive with the comments in the code.  This is a topic which can lead to confusion quickly, as we are describing nested rotations about multiple axes and reflections, etc.  For the front-facing camera, we also mirror the screen window (not the buffer being recorded!).
